query getProjectsPipelines(
    $ids: [ID!]
    $source: String
    $updatedAfter: Time
    $updatedBefore: Time
    $endCursor: String
    # field fragments (choose one)
    $_core: Boolean!
    $_relations: Boolean!
){
    projects(ids: $ids, after: $endCursor) {
        nodes {
            ...ProjectReferenceFields

            pipelines(
                scope: FINISHED
                source: $source
                updatedAfter: $updatedAfter
                updatedBefore: $updatedBefore
            ) {
                nodes {
                    ...PipelineReferenceFields

                    ...PipelineFieldsCore @include(if: $_core)
                    ...PipelineFieldsRelations @include(if: $_relations)
                }
                pageInfo {
                    ...pageFields
                }
            }
        }
        pageInfo {
            ...pageFields
        }
    }
}

query getProjectPipelines(
    $projectPath: ID!
    $source: String
    $updatedAfter: Time
    $updatedBefore: Time
    $endCursor: String
    # field fragments (choose one)
    $_core: Boolean!
    $_relations: Boolean!
) {
    project(fullPath: $projectPath) {
        ...ProjectReferenceFields

        pipelines(
            scope: FINISHED
            source: $source
            updatedAfter: $updatedAfter
            updatedBefore: $updatedBefore
            after: $endCursor
        ) {
            nodes {
                ...PipelineReferenceFields

                ...PipelineFieldsCore @include(if: $_core)
                ...PipelineFieldsRelations @include(if: $_relations)
            }
            pageInfo {
                ...pageFields
            }
        }
    }
}

query getProjectPipelineDownstream(
    $projectPath: ID!
    $pipelineIid: ID!
    $endCursor: String
) {
    project(fullPath: $projectPath) {
        ...ProjectReferenceFields

        pipeline(iid: $pipelineIid) {
            downstream(after: $endCursor) {
                nodes {
                    ...PipelineReferenceFields
                    project {
                        ...ProjectReferenceFields
                    }
                }
                pageInfo {
                    ...pageFields
                }
            }
        }
    }
}

query getProjectPipeline(
    $projectId: ID!
    $pipelineId: CiPipelineID!
    # field fragments
    $_core: Boolean!
    $_relations: Boolean!
) {
    projects(ids: [$projectId]){
        nodes {
            ...ProjectReferenceFields

            pipeline(id: $pipelineId) {
                ...PipelineReferenceFields

                ...PipelineFieldsCore @include(if: $_core)
                ...PipelineFieldsRelations @include(if: $_relations)
            }
        }
    }
}
